{% extends 'layout.html' %}

{% block body %}
<script src="/static/js/jquery-3.1.1.js"></script>

<div class="jumbotron text-center">
    <h1>Cartoonify</h1>
    
    <h2>Click your image below to designate the following points in this order:</h2>
    <table class="image" align="center">
        <tr>
          <td>
            <p>Left Ear:</p>
            <img src= "{{ url_for('static', filename='examples/' + 'hueyRed.jpg') }}" width="250">
          </td>
          <td>
            <p>Neck:</p>
            <img src= "{{ url_for('static', filename='examples/' + 'hueyBlue.jpg') }}" width="250">
          </td>
          <td>
            <p>Right Shoulder:</p>
            <img src= "{{ url_for('static', filename='images/' + 'hueyYellow.jpg') }}" width="250">
          </td>
          <td>
            <p>Left Shoulder:</p>
            <img src= "{{ url_for('static', filename='images/' + 'hueyGreen.jpg') }}" width="250">
          </td>
        </tr>
      </table>

   
    <canvas id = "points_image" width = "600" height = "800"></canvas>

    <h3>Left and right are from the person in the picture's perspective</h3>
    <form id = "points_form" action="{{ url_for('add_points', filename=filename) }}" method="post" enctype="multipart/form-data">
        <span class="btn btn-default btn-file">
            Left Ear X:<br>
            <input type="text" name="leftearX" value=""><br>
            Left Ear Y:<br>
            <input type="text" name="leftearY" value=""><br>
            Neck X:<br>
            <input type="text" name="neckX" value=""><br>
            Neck Y:<br>
            <input type="text" name="neckY" value=""><br>
            Right Shoulder X:<br>
            <input type="text" name="rightshoulderX" value=""><br>
            Right Shoulder Y:<br>
            <input type="text" name="rightshoulderY" value=""><br>
            Left Shoulder X:<br>
            <input type="text" name="leftshoulderX" value=""><br>
            Left Shoulder Y:<br>
            <input type="text" name="leftshoulderY" value=""><br>
        </span>

        <input type="submit" value="Confirm points" class="btn btn-primary">
    </form>    

    
    <script language = "Javascript">
        var canvas = document.getElementById("points_image");
        var context = canvas.getContext('2d');
        var form = document.getElementById("points_form");

        image = new Image();
        image.src = "{{ url_for('add_points', filename = filename)}}"
        image.onload = function() {
            context.drawImage(image, 0, 0);
        };

        canvas.addEventListener('click', function(event) {
            // Get x and y coordinates of click event on canvas
            var x = event.pageX - canvas.offsetLeft;
            var y = event.pageY - canvas.offsetTop;

            // Find the first empty X and Y input text boxes and complete them
            for (var i = 0; i < form.elements.length; i++) {
                textinput = form.elements[i];

                if (textinput.value === "" && textinput.name.slice(-1) === "X") {
                    textinput.value = x;
                    form.elements[i + 1].value = y;
                    break;
                }
            }
        });

    </script>

</div>


{% endblock %}
